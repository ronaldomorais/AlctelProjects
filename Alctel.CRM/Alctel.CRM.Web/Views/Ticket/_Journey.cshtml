@model Alctel.CRM.Web.Models.TicketModel

@{
	var profileSession = Context.Session.GetString("Profile");
	string profile = string.Empty;

	if (profileSession != null)
	{
		profile = profileSession;
	}

	string? ticketMessage = (string)ViewBag.TicketMessage;

	var childProtocol = (string)ViewBag.ChildProtocol;
	// Int64 childTicketId = Int64.Parse((string)ViewBag.ChildTicketId);
}

<div class="card">
	<div class="card-header">
		<h5 class="mb-0">
			@* <form method="get" asp-action="Add"> *@
			<svg xmlns="http://www.w3.org/2000/svg" class="bi bi-person-lines-fill" viewBox="0 0 16 16">
				<path d="M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m-5 6s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zM11 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5m.5 2.5a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1zm2 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1z" />
			</svg>
			<button type="submit" class="btn btn-title-style" type="button" data-toggle="collapse"
					data-bs-toggle="collapse" data-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
				Protocolo Pai: @Model.Protocol -> Protocolo Filho: @childProtocol
			</button>

			@* </form> *@
		</h5>
	</div>

	<div class="card card-body">

		@* 		@if (childTicketId < 0)
		{
			<div class="row small mb-3">
				<div class="alert alert-warning alert-dismissible alert-small fade show" role="alert" id="userFilterMessage">
					Para vincular um <strong>Protocolo Filho (@childProtocol)</strong> à um <strong>Protolo Pai (@Model.Protocol)</strong> é necessário salvar primeiramente o Protocolo Filho.
					<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
				</div>
			</div>
		} *@

		@* <form method="post" asp-action="BindTicket"> *@
		<div class="row small mb-3">

			@if (string.IsNullOrEmpty(ticketMessage) == false)
			{
				@if (ticketMessage.Contains("Erro"))
				{
					<div class="alert alert-danger" role="alert">
						@ticketMessage
					</div>
				}
				else
				{
					<div class="alert alert-success" role="alert">
						@ticketMessage
					</div>
				}
			}
		</div>


		<input type="hidden" asp-for="@Model.Id" value="@Model.Id" />

		<div class="row smal mb-3">
			<div class="col-sm-4">
				<label asp-for="@Model.Customer.FirstName">Nome:</label>
				<div class="input-group input-group-sm mb-3">
					<div>
						<input class="standard-input" type="text" asp-for="@Model.Customer.FirstName"
							   aria-describedby="basic-addon2" readonly style="background-color:#E2E8F0;" />
					</div>
				</div>
			</div>

			<div class="col-sm-4">
				<label asp-for="@Model.Customer.SocialAffectionateName">Nome Social/Afetivo:</label>
				<div class="input-group input-group-sm mb-3">
					<div>
						<input class="standard-input" type="text"
							   asp-for="@Model.Customer.SocialAffectionateName"
							   aria-describedby="basic-addon2" readonly style="background-color:#E2E8F0;" />
					</div>
				</div>
			</div>

			<div class="col-sm-4">
				<label asp-for="@Model.Customer.Cpf"></label>
				<div class="input-group input-group-sm mb-3">
					<div>
						<input class="standard-input" type="text" asp-for="@Model.Customer.Cpf"
							   aria-describedby="basic-addon2" readonly style="background-color:#E2E8F0;" />
					</div>
				</div>
			</div>
		</div>

		<div class="row smal mb-3">
			<div class="col-sm-4">
				<label asp-for="@Model.Protocol"></label>
				<div class="input-group input-group-sm mb-3">
					<div>
						<input class="standard-input" type="text" asp-for="@Model.Protocol"
							   aria-describedby="basic-addon2" readonly style="background-color:#E2E8F0;" />
					</div>
				</div>
			</div>

			<div class="col-sm-4">
				<label asp-for="@Model.CustomerNavigation"></label>
				<div class="input-group input-group-sm mb-3">
					<div>
						<input class="standard-input" type="text" asp-for="@Model.CustomerNavigation"
							   aria-describedby="basic-addon2" readonly style="background-color:#E2E8F0;" />
					</div>
				</div>
			</div>

			<div class="col-sm-4">
				<label asp-for="@Model.QueueGenesys"></label>
				<div class="input-group input-group-sm mb-3">
					<div>
						<input class="standard-input" type="text" asp-for="@Model.QueueGenesys"
							   aria-describedby="basic-addon2" readonly style="background-color:#E2E8F0;" />
					</div>
				</div>
			</div>
		</div>


		<div class="row smal mb-3">


			<div class="col-sm-4">
				<label asp-for="@Model.QueueGTId"></label>
				<div class="input-group input-group-sm mb-3">
					<div>
						<select asp-for="@Model.QueueGTId"
								asp-items="@Model.QueueGTOptions" style="background-color:#E2E8F0;" disabled="true">
						</select>
					</div>
				</div>
			</div>

		@* 	<div class="col-sm-4">
				<label asp-for="@Model.DemandTypeId"></label>
				<div class="input-group input-group-sm mb-3">
					<div>
						<select asp-for="@Model.DemandTypeId"
								asp-items="@Model.DemandTypeOptions" style="background-color:#E2E8F0;" disabled="true">
						</select>
					</div>
				</div>
			</div> *@

			<div class="col-sm-4">
				<label asp-for="@Model.TicketCriticalityId"></label>
				<div class="input-group input-group-sm mb-3">
					<div>
						<select class="ticket_init" asp-for="@Model.TicketCriticalityId"
								asp-items="@Model.TicketCriticalityOptions" style="background-color:#E2E8F0;" disabled="true">
						</select>
					</div>
				</div>
			</div>

		</div>

		<div class="row smal mb-3">

			<div class="col-sm-4">
				<label asp-for="@Model.ProtocolDate"></label>
				<div class="input-group input-group-sm mb-3">
					<div>
						<input class="standard-input" type="date" asp-for="@Model.ProtocolDate"
							   aria-describedby="basic-addon2" readonly style="background-color:#E2E8F0;" />
					</div>
				</div>
			</div>

			<div class="col-sm-4">
				<label asp-for="@Model.SlaSystemRole"></label>
				<div class="input-group input-group-sm mb-3">
					<div>
						<input class="standard-input" type="text" asp-for="@Model.SlaSystemRole"
							   aria-describedby="basic-addon2" readonly style="background-color:#E2E8F0;" />
					</div>
				</div>
			</div>

			<div class="col-sm-4">
				<label asp-for="@Model.Sla"></label>
				<div class="input-group input-group-sm mb-3">
					<div>
						<input class="standard-input" type="text" asp-for="@Model.Sla"
							   aria-describedby="basic-addon2" readonly style="background-color:#E2E8F0;" />
					</div>
				</div>
			</div>


		</div>

		<div class="row smal mb-3">

			<div class="col-sm-4">
				<label asp-for="@Model.Thermometer"></label>
				<div class="input-group input-group-sm mb-3">
					<div>
						<input class="standard-input" type="text" asp-for="@Model.Thermometer"
							   aria-describedby="basic-addon2" readonly style="background-color:#E2E8F0;" />
					</div>
				</div>
			</div>


			<div class="col-sm-4">
				<label asp-for="@Model.TicketStatusId"></label>
				<div class="input-group input-group-sm mb-3">
					<div>
						<select class="ticket_init" asp-for="@Model.TicketStatusId"
								asp-items="@Model.TicketStatusOptions" style="background-color:#E2E8F0;" disabled="true">
						</select>
					</div>
				</div>
			</div>

			<div class="col-sm-4">
				<label asp-for="@Model.AnySolution"></label>
				<div class="input-group input-group-sm mb-3">
					<div>
						<select class="ticket_init" asp-for="@Model.AnySolution"
								asp-items="@Model.AnySolutionOptions" style="background-color:#E2E8F0;" disabled="true">
						</select>
					</div>
				</div>
			</div>

		</div>

		<div class="row smal mb-3">
			@if (string.IsNullOrEmpty(Model.DemandInformation) == false)
			{
				<div class="col-sm-12" style="width: 99%;">
					<label asp-for="@Model.DemandInformation"></label>
					<input type="hidden" asp-for="@Model.DemandInformation" />
					<div class="col-sm-12" style="border: 1px solid #ccc;">
						<a href="@Model.DemandInformation" target="_blank">Email</a>
					</div>
				</div>
			}
		</div>

		<div class="row smal mb-3">

			<div class="col-sm-12">
				<label asp-for="@Model.DemandObservation"></label>
				<div class="input-group input-group-sm mb-3">
					<div>
						<textarea asp-for="@Model.DemandObservation" rows="8" style="width:99%;" placeholder="Digite aqui" style="background-color:#E2E8F0;" disabled="true">
																	</textarea>
					</div>
				</div>
			</div>
		</div>



		<div class="row smal mb-3">
			<h5 class="mb-0">
				<svg xmlns="http://www.w3.org/2000/svg" class="bi bi-person-lines-fill" viewBox="0 0 16 16">
					<path d="M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m-5 6s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zM11 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5m.5 2.5a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1zm2 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1z" />
				</svg>
				<button class="btn btn-title-style" type="button" data-toggle="collapse"
						data-bs-toggle="collapse" data-target="#collapseOne" aria-expanded="false"
						aria-controls="collapseOne">
					Classificação
				</button>
			</h5>
		</div>

		<div class="row smal mb-3" style="margin:10px;">
			<table id="ticketClassificationTableId" class="table table-striped table-sm"
				   style="margin-top: 50px;background-color: #f2f2f2;">
				<thead>
					<tr style="color: #666666 !important; font-weight: bold;">
						<th scope="col">Manifestação</th>
						<th scope="col">Unidade</th>
						<th scope="col">Serviço</th>
						<th scope="col">Motivo 1</th>
						<th scope="col">Motivo 2</th>
						<th scope="col">Usuário</th>
					</tr>
				</thead>
				<tbody>

					@if (Model.TicketClassification != null && Model.TicketClassification.Count > 0)
					{
						for (int c = 0; c < Model.TicketClassification.Count; c++)
						{
							<tr>
								<td>
									<input type="hidden" name="TicketClassification[@c].ManifestationTypeId" value="@Model.TicketClassification[@c].ManifestationTypeId" />
									<input type="hidden" name="TicketClassification[@c].ManifestationTypeName" value="@Model.TicketClassification[@c].ManifestationTypeName" />
									@Model.TicketClassification[@c].ManifestationTypeName
								</td>
								<td>
									<input type="hidden" name="TicketClassification[@c].ServiceUnitId" value="@Model.TicketClassification[@c].ServiceUnitId" />
									<input type="hidden" name="TicketClassification[@c].ServiceUnitName" value="@Model.TicketClassification[@c].ServiceUnitName" />

									@Model.TicketClassification[@c].ServiceUnitName
								</td>
								<td>
									<input type="hidden" name="TicketClassification[@c].ServiceId" value="@Model.TicketClassification[@c].ServiceId" />
									<input type="hidden" name="TicketClassification[@c].ServiceName" value="@Model.TicketClassification[@c].ServiceName" />

									@Model.TicketClassification[@c].ServiceName
								</td>
								<td>
									<input type="hidden" name="TicketClassification[@c].Reason01Id" value="@Model.TicketClassification[@c].Reason01Id" />
									<input type="hidden" name="TicketClassification[@c].Reason01ListName" value="@Model.TicketClassification[@c].Reason01ListName" />
									<input type="hidden" name="TicketClassification[@c].Reason01ListId" value="@Model.TicketClassification[@c].Reason01ListId" />

									@Model.TicketClassification[@c].Reason01Name
								</td>
								<td>
									<input type="hidden" name="TicketClassification[@c].Reason02Id" value="@Model.TicketClassification[@c].Reason02Id" />
									<input type="hidden" name="TicketClassification[@c].Reason02ListName" value="@Model.TicketClassification[@c].Reason02ListName" />
									<input type="hidden" name="TicketClassification[@c].Reason02ListId" value="@Model.TicketClassification[@c].Reason02ListId" />

									@Model.TicketClassification[@c].Reason02Name
								</td>
								<td>
									<input type="hidden" name="TicketClassification[@c].UserId" value="@Model.TicketClassification[@c].UserId" />
									@Model.TicketClassification[@c].UserId
								</td>
							</tr>
						}
					}

				</tbody>
			</table>
		</div>

		@* 			<div class="row smal mb-3">
				<div class="col-sm-1">
					<h5 class="mb-0">
						<svg xmlns="http://www.w3.org/2000/svg" class="bi bi-person-lines-fill"
							 viewBox="0 0 16 16">
							<path d="M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m-5 6s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zM11 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5m.5 2.5a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1zm2 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1z" />
						</svg>
						<button class="btn btn-title-style" type="button" data-toggle="collapse"
								data-bs-toggle="collapse" data-target="#collapseOne" aria-expanded="false"
								aria-controls="collapseOne">
							Anexos
						</button>
					</h5>
				</div>
				<div class="col-sm-2">
				</div>
			</div> 

			<div class="row smal mb-3">
				<div class="custom-file" style="margin-bottom: 20px;">
					<input type="file" id="files" name="files[]" multiple style="display: none;" />
					<label class="custom-file-input" for="files"
						   style="background-color:#e2e6ee; color:#666666; font-weight:bold; padding:5px; border-radius: 5px;">Anexar</label>
				</div>
			</div>
			<div class="row smal mb-3" style="margin-bottom:5px;">
				<div id="filelist" style="display: inline">
				</div>
			</div> *@

		<button type="button" class="btn btn-style" data-bs-dismiss="modal" onclick="tools.Events.OnBindTicket(@Model.Protocol)">Vincular</button>

		@* </form> *@


		@* 	@if (Model.Logs != null && Model.Logs.Any())
		{
			<table class="table table-striped table-sm" style="margin-top: 50px;background-color: #f2f2f2;">
				<thead>
					<tr>
						<th scope="col"></th>
						<th scope="col">Data</th>
						<th scope="col">Hora</th>
						<th scope="col">Objeto</th>
						<th scope="col">Módulo</th>
						<th scope="col">Usuário</th>
						<th scope="col">Campo</th>
						<th scope="col">Valor Anterior</th>
						<th scope="col">Ação</th>
					</tr>
				</thead>
				<tbody>
					@foreach (var item in Model.Logs)
					{
						<tr>
							<td>Log de Controle: </td>
							<td>@item.LogEvent.ToString("dd/MM/yyyy")</td>
							<td>@item.LogEvent.ToString("HH:mm")</td>
							<td>@item.User</td>
							<td>@item.Module</td>
							<td>@item.Section</td>
							<td>@item.Field</td>
							<td>@item.Value</td>
							<td>@item.Action</td>
						</tr>
					}
				</tbody>
			</table>
		} *@
	</div>


</div>


